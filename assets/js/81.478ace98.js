(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{508:function(s,a,e){"use strict";e.r(a);var t=e(22),r=Object(t.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),a("p",[s._v("https://www.runoob.com/docker/ubuntu-docker-install.html")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("systemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开机自启")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#镜像"}},[s._v("#")]),s._v(" 镜像")]),s._v(" "),a("h3",{attrs:{id:"拉镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#拉镜像"}},[s._v("#")]),s._v(" 拉镜像")]),s._v(" "),a("p",[s._v("镜像 http://hub.daocloud.io")]),s._v(" "),a("p",[s._v("docker pull 镜像名称[:tag]")]),s._v(" "),a("p",[s._v("如果要到"),a("code",[s._v("daocloud")]),s._v("上拉 "),a("code",[s._v("docker pull daocloud.io/library/tomcat:8.5.15-jre8")])]),s._v(" "),a("h3",{attrs:{id:"查看本地镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看本地镜像"}},[s._v("#")]),s._v(" 查看本地镜像")]),s._v(" "),a("p",[s._v("docker images")]),s._v(" "),a("h3",{attrs:{id:"删除本地镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#删除本地镜像"}},[s._v("#")]),s._v(" 删除本地镜像")]),s._v(" "),a("p",[a("code",[s._v("docker rmi 镜像的标识（通过docker images查看到 image id）")])]),s._v(" "),a("p",[s._v("删除全部本地镜像 "),a("code",[s._v("docker rmi $(docker images)")])]),s._v(" "),a("h3",{attrs:{id:"镜像的导入导出-不规范"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#镜像的导入导出-不规范"}},[s._v("#")]),s._v(" 镜像的导入导出（不规范）")]),s._v(" "),a("p",[s._v("导出 docker save -o 导出路径 镜像ID 如 "),a("code",[s._v("docker save -o ./tomcat.image b8")])]),s._v(" "),a("p",[s._v("导入 docker load -i 镜像文件 如 "),a("code",[s._v("docker load -i tomcat.image")])]),s._v(" "),a("p",[s._v("导入后没有名字和版本 通过 docker tag 镜像id 新镜像名称:版本 如 "),a("code",[s._v("docker tag b8 tomcat:8.5")])]),s._v(" "),a("h2",{attrs:{id:"容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#容器"}},[s._v("#")]),s._v(" 容器")]),s._v(" "),a("h3",{attrs:{id:"运行容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#运行容器"}},[s._v("#")]),s._v(" 运行容器")]),s._v(" "),a("p",[s._v("docker run -d -p 宿主机端口:窗口端口 --name 容器名称 镜像的标识|镜像名称[:tag]")]),s._v(" "),a("p",[s._v("-d: 后台运行")]),s._v(" "),a("p",[s._v("-p 宿主机端口:窗口端口: 为了映射当前Linux的端口和容器的端口")]),s._v(" "),a("p",[s._v("--name 容器名称 镜像的标识|镜像名称[:tag]:")]),s._v(" "),a("p",[s._v("如 "),a("code",[s._v("docker run -d -p 8081:8080 --name tomcat b8")])]),s._v(" "),a("h3",{attrs:{id:"查看正在运行的容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看正在运行的容器"}},[s._v("#")]),s._v(" 查看正在运行的容器")]),s._v(" "),a("p",[a("code",[s._v("docker ps [-qa]")])]),s._v(" "),a("p",[s._v("-a：查看全部的容器，包括没有运行的")]),s._v(" "),a("p",[s._v("-q：只查看容器得到标识")]),s._v(" "),a("h3",{attrs:{id:"查看容器的日志"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看容器的日志"}},[s._v("#")]),s._v(" 查看容器的日志")]),s._v(" "),a("p",[s._v("docker logs -f 容器ID --tail 100")]),s._v(" "),a("h3",{attrs:{id:"进入容器内部"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#进入容器内部"}},[s._v("#")]),s._v(" 进入容器内部")]),s._v(" "),a("p",[s._v("docker exec -it 容器ID bash")]),s._v(" "),a("h3",{attrs:{id:"退出容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#退出容器"}},[s._v("#")]),s._v(" 退出容器")]),s._v(" "),a("p",[a("code",[s._v("ctrl+p+q")])]),s._v(" "),a("h3",{attrs:{id:"删除容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#删除容器"}},[s._v("#")]),s._v(" 删除容器")]),s._v(" "),a("p",[s._v("删除前，需要先停止")]),s._v(" "),a("p",[s._v("停止指定的容器 "),a("code",[s._v("docker stop 容器ID")])]),s._v(" "),a("p",[s._v("停止全部容器 "),a("code",[s._v("docker stop $(docker ps -qa)")])]),s._v(" "),a("p",[s._v("删除指定的容器 "),a("code",[s._v("docker rm 容器id")])]),s._v(" "),a("p",[s._v("删除全部容器 "),a("code",[s._v("docker rm $(docker ps -qa)")])]),s._v(" "),a("h3",{attrs:{id:"启动容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动容器"}},[s._v("#")]),s._v(" 启动容器")]),s._v(" "),a("p",[s._v("docker start 容器ID")]),s._v(" "),a("h3",{attrs:{id:"应用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#应用"}},[s._v("#")]),s._v(" 应用")]),s._v(" "),a("h4",{attrs:{id:"安装mysql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装mysql"}},[s._v("#")]),s._v(" 安装"),a("code",[s._v("mysql")])]),s._v(" "),a("p",[a("code",[s._v("docker run -d -p 3306:3306 --name mysql -e MYSQL_ROOT_PASSWORD=root daocloud.io/library/mysql:5.7.4")])]),s._v(" "),a("h4",{attrs:{id:"安装nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装nginx"}},[s._v("#")]),s._v(" 安装"),a("code",[s._v("nginx")])]),s._v(" "),a("p",[a("code",[s._v("docker run -d -p 80:80 --name nginx daocloud.io/library/nginx:1.7.8")])]),s._v(" "),a("p",[s._v("把文件放到"),a("code",[s._v("nginx")]),s._v("里：")]),s._v(" "),a("p",[a("code",[s._v("docker cp 文件名 容器id:容器内部路径")]),s._v(" 如 "),a("code",[s._v("docker cp test.html e0:/usr/share/nginx/html/")])]),s._v(" "),a("h3",{attrs:{id:"数据卷"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据卷"}},[s._v("#")]),s._v(" 数据卷")]),s._v(" "),a("p",[s._v("将宿主机的一个目录映射到容器的一个目录中。")]),s._v(" "),a("h4",{attrs:{id:"创建数据卷"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建数据卷"}},[s._v("#")]),s._v(" 创建数据卷")]),s._v(" "),a("p",[s._v("docker volume create 数据卷名称")]),s._v(" "),a("p",[s._v("创建数据卷之后，默认会存放在一个目录下/var/lib/docker/volumes/数据卷名称/_data")]),s._v(" "),a("h4",{attrs:{id:"查看数据卷的详细信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看数据卷的详细信息"}},[s._v("#")]),s._v(" 查看数据卷的详细信息")]),s._v(" "),a("p",[s._v("docker volume inspect 数据卷名称")]),s._v(" "),a("h4",{attrs:{id:"查看全部数据卷"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看全部数据卷"}},[s._v("#")]),s._v(" 查看全部数据卷")]),s._v(" "),a("p",[s._v("docker volume ls")]),s._v(" "),a("h4",{attrs:{id:"删除数据卷"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#删除数据卷"}},[s._v("#")]),s._v(" 删除数据卷")]),s._v(" "),a("p",[s._v("docker volume rm 数据卷名称")]),s._v(" "),a("h4",{attrs:{id:"应用数据卷"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#应用数据卷"}},[s._v("#")]),s._v(" 应用数据卷")]),s._v(" "),a("p",[s._v("1、当映射数据卷时，如果数据卷不存在，docker会帮你自动创建，这种方式会将容器内部自带的文件，存储在默认的存放路径中。")]),s._v(" "),a("p",[a("code",[s._v("docker run -v 数据卷名称:容器内部的路径 镜像id")])]),s._v(" "),a("p",[a("code",[s._v("docker run -d -p 80:80 --name nginx -v nginx:/usr/share/nginx/html/ a3")])]),s._v(" "),a("p",[s._v("2、也可以直接指定一个路径作为数据卷的存放位置，这种方式路径下是空的，不会带上原来的。")]),s._v(" "),a("p",[a("code",[s._v("docker run -v 路径:容器内部的路径 镜像id")])]),s._v(" "),a("h2",{attrs:{id:"自定义镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自定义镜像"}},[s._v("#")]),s._v(" 自定义镜像")]),s._v(" "),a("p",[s._v("创建一个"),a("code",[s._v("Dockerfile")]),s._v("文件，并且指定自定义镜像信息")]),s._v(" "),a("h3",{attrs:{id:"dockerfile"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile"}},[s._v("#")]),s._v(" "),a("code",[s._v("Dockerfile")])]),s._v(" "),a("p",[a("code",[s._v("Dockerfile")]),s._v("文件中常用的内容")]),s._v(" "),a("p",[s._v("from: 指定当前自定义镜像依赖的环境")]),s._v(" "),a("p",[s._v("copy: 将相对路径下的内容复制到自定义镜像中")]),s._v(" "),a("p",[a("code",[s._v("workdir")]),s._v(": 声明镜像的默认工作目录")]),s._v(" "),a("p",[a("code",[s._v("cmd")]),s._v(": 需要执行的命令（在"),a("code",[s._v("workdir")]),s._v("下执行的，"),a("code",[s._v("cmd")]),s._v("可以写多个，只以最后一个为准）")]),s._v(" "),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" daocloud.io/library/nginx:1.7.8")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("copy")]),s._v(" test.html /usr/share/nginx/html")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"制作镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#制作镜像"}},[s._v("#")]),s._v(" 制作镜像")]),s._v(" "),a("p",[s._v("将准备好的"),a("code",[s._v("Dockerfile")]),s._v("和相应的文件放到同一个目录下，通过Docker的命令制作镜像")]),s._v(" "),a("p",[s._v("docker build -t 镜像名称:tag . (最后一个点不要忘掉，表示当前目录)")]),s._v(" "),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[s._v("docker build -t nginx-web-html:1.0.0 .\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("3、"),a("code",[s._v("Dockerfile")]),s._v("举例")]),s._v(" "),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" nginx")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" default.conf /etc/nginx/conf.d/default.conf")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" dist /usr/share/nginx/html")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h2",{attrs:{id:"docker-compose"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose"}},[s._v("#")]),s._v(" Docker-Compose")]),s._v(" "),a("ul",[a("li",[s._v("之前运行一个镜像，需要添加大量的参数")]),s._v(" "),a("li",[s._v("可以通过Docker-Compose编写这些参数")]),s._v(" "),a("li",[s._v("Docker-Compose可以帮助我们批量的管理容器")]),s._v(" "),a("li",[s._v("只需要通过一个"),a("code",[s._v("docker-compose.yml")]),s._v("文件去维护即可。")])]),s._v(" "),a("h3",{attrs:{id:"管理容器命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#管理容器命令"}},[s._v("#")]),s._v(" 管理容器命令")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" up "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动管理的容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" down "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭并删除容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" start"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("stop"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("restart "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开启或关闭已经存在的由docker-compose维护的容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看由docker-compose管理的容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" logs "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看日志")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"应用-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#应用-2"}},[s._v("#")]),s._v(" 应用")]),s._v(" "),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[s._v('version: "3.9"\n\nservices:\n  mysql:\n    image: \'mysql:8\'\n    ports:\n      - 3306:3306\n    env_file:\n      - ./mysql/mysql.env\n    volumes:\n      - ./mysql/conf.d:/etc/mysql/conf.d\n      - ./mysql/data:/var/lib/mysql\n      - ./mysql/docker-entrypoint-initdb.d:/docker-entrypoint-initdb.d\n    restart: always\n\n  pma:\n    image: phpmyadmin/phpmyadmin:latest\n    env_file:\n      - ./phpmyadmin/phpmyadmin.env\n    depends_on:\n      - mysql\n    links:\n      - "mysql:db"\n    ports:\n      - "1001:80"\n    restart: always\n\n  redis:\n    image: \'redis:latest\'\n    command: redis-server /usr/local/etc/redis/redis.conf\n    ports:\n      - "6379:6379"\n    volumes:\n      - ./redis/data:/data\n      - ./redis/redis.conf:/usr/local/etc/redis/redis.conf\n    restart: always\n\n  rabbitmq:\n    image: \'rabbitmq:3-management\'\n    hostname: myrabbitmq\n    env_file:\n      - ./rabbitmq/rabbitmq.env\n    volumes:\n      - ./rabbitmq/data/:/var/lib/rabbitmq/\n    ports:\n      - 15672:15672\n      - 5672:5672\n      - 1883:1883\n    restart: always\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br")])])])}),[],!1,null,null,null);a.default=r.exports}}]);