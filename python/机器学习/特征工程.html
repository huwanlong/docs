<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>特征工程 | 走在小路上</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css">
    <link rel="icon" href="/icons/favicon.ico">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
    <meta name="description" content="走在小路上的笔记">
    <meta rel="author" href="走在小路上">
    <meta rel="keywords" href="前端、Vue、Node.js、Python、AI">
    <meta name="theme-color" content="#0aa">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.3244b6bc.css" as="style"><link rel="preload" href="/assets/js/app.dc113988.js" as="script"><link rel="preload" href="/assets/js/8.fcf2fa6b.js" as="script"><link rel="preload" href="/assets/js/1.884f0c81.js" as="script"><link rel="preload" href="/assets/js/71.58dad522.js" as="script"><link rel="preload" href="/assets/js/20.a18fb072.js" as="script"><link rel="prefetch" href="/assets/js/11.9f522531.js"><link rel="prefetch" href="/assets/js/12.f7ec24e4.js"><link rel="prefetch" href="/assets/js/13.f347bed0.js"><link rel="prefetch" href="/assets/js/14.5b3e0d94.js"><link rel="prefetch" href="/assets/js/15.8162750b.js"><link rel="prefetch" href="/assets/js/16.fba4b099.js"><link rel="prefetch" href="/assets/js/17.297b13c2.js"><link rel="prefetch" href="/assets/js/18.c5704e74.js"><link rel="prefetch" href="/assets/js/19.9821883c.js"><link rel="prefetch" href="/assets/js/2.ec30f522.js"><link rel="prefetch" href="/assets/js/21.9652916b.js"><link rel="prefetch" href="/assets/js/22.5fa099b5.js"><link rel="prefetch" href="/assets/js/23.19b8bad0.js"><link rel="prefetch" href="/assets/js/24.b3dbefa0.js"><link rel="prefetch" href="/assets/js/25.0e82438f.js"><link rel="prefetch" href="/assets/js/26.ba6de903.js"><link rel="prefetch" href="/assets/js/27.a11437df.js"><link rel="prefetch" href="/assets/js/28.2fdfd243.js"><link rel="prefetch" href="/assets/js/29.ddeaa57d.js"><link rel="prefetch" href="/assets/js/3.42a04905.js"><link rel="prefetch" href="/assets/js/30.e12a9ed9.js"><link rel="prefetch" href="/assets/js/31.aee80350.js"><link rel="prefetch" href="/assets/js/32.a8eafe03.js"><link rel="prefetch" href="/assets/js/33.7f74e581.js"><link rel="prefetch" href="/assets/js/34.84883096.js"><link rel="prefetch" href="/assets/js/35.b2798889.js"><link rel="prefetch" href="/assets/js/36.ab744a75.js"><link rel="prefetch" href="/assets/js/37.ec282544.js"><link rel="prefetch" href="/assets/js/38.ed14e099.js"><link rel="prefetch" href="/assets/js/39.76edc745.js"><link rel="prefetch" href="/assets/js/4.6967fa32.js"><link rel="prefetch" href="/assets/js/40.eaca521a.js"><link rel="prefetch" href="/assets/js/41.9a317b26.js"><link rel="prefetch" href="/assets/js/42.28a8c2e9.js"><link rel="prefetch" href="/assets/js/43.1b56829e.js"><link rel="prefetch" href="/assets/js/44.678803d9.js"><link rel="prefetch" href="/assets/js/45.93287a3a.js"><link rel="prefetch" href="/assets/js/46.09d32dd6.js"><link rel="prefetch" href="/assets/js/47.e2716d03.js"><link rel="prefetch" href="/assets/js/48.9f1e142e.js"><link rel="prefetch" href="/assets/js/49.3dbf0fc2.js"><link rel="prefetch" href="/assets/js/5.1a21dc25.js"><link rel="prefetch" href="/assets/js/50.457f2e13.js"><link rel="prefetch" href="/assets/js/51.53edcbaf.js"><link rel="prefetch" href="/assets/js/52.8a8d2cb7.js"><link rel="prefetch" href="/assets/js/53.7c5f9cf1.js"><link rel="prefetch" href="/assets/js/54.13dcfac6.js"><link rel="prefetch" href="/assets/js/55.44afedaf.js"><link rel="prefetch" href="/assets/js/56.bc1e0ee2.js"><link rel="prefetch" href="/assets/js/57.f65507ba.js"><link rel="prefetch" href="/assets/js/58.922bec59.js"><link rel="prefetch" href="/assets/js/59.880eddbb.js"><link rel="prefetch" href="/assets/js/6.f7798969.js"><link rel="prefetch" href="/assets/js/60.50514aec.js"><link rel="prefetch" href="/assets/js/61.44cf4e69.js"><link rel="prefetch" href="/assets/js/62.b2a55195.js"><link rel="prefetch" href="/assets/js/63.deacc3ea.js"><link rel="prefetch" href="/assets/js/64.9266494b.js"><link rel="prefetch" href="/assets/js/65.cf68aa60.js"><link rel="prefetch" href="/assets/js/66.2c7a5a22.js"><link rel="prefetch" href="/assets/js/67.f7b36b6f.js"><link rel="prefetch" href="/assets/js/68.116fa4c9.js"><link rel="prefetch" href="/assets/js/69.b7de63e3.js"><link rel="prefetch" href="/assets/js/7.986c406d.js"><link rel="prefetch" href="/assets/js/70.462906ca.js"><link rel="prefetch" href="/assets/js/72.baf146c8.js"><link rel="prefetch" href="/assets/js/73.d35725ef.js"><link rel="prefetch" href="/assets/js/74.108b8cab.js"><link rel="prefetch" href="/assets/js/75.ced283ae.js"><link rel="prefetch" href="/assets/js/76.8b88100b.js"><link rel="prefetch" href="/assets/js/77.13146522.js"><link rel="prefetch" href="/assets/js/78.d8b96da3.js"><link rel="prefetch" href="/assets/js/79.164f57aa.js"><link rel="prefetch" href="/assets/js/80.52f0042f.js"><link rel="prefetch" href="/assets/js/81.f2e92e3a.js"><link rel="prefetch" href="/assets/js/82.19fdf108.js"><link rel="prefetch" href="/assets/js/83.b65c981e.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.15664e14.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3244b6bc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/icons/apple-touch-icon.png" alt="走在小路上" class="logo"> <span class="site-name can-hide">走在小路上</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Web" class="dropdown-title"><span class="title">Web</span> <span class="arrow down"></span></button> <button type="button" aria-label="Web" class="mobile-dropdown-title"><span class="title">Web</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/tools/" class="nav-link">
  Tools
</a></li><li class="dropdown-item"><!----> <a href="/frontend/React/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/frontend/electron/" class="nav-link">
  Electron
</a></li><li class="dropdown-item"><!----> <a href="/frontend/webpack4/" class="nav-link">
  Webpack4
</a></li><li class="dropdown-item"><!----> <a href="/frontend/SSR/" class="nav-link">
  Vue SSR
</a></li><li class="dropdown-item"><!----> <a href="/frontend/MicroApp/" class="nav-link">
  MicroApp
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Python" class="dropdown-title"><span class="title">Python</span> <span class="arrow down"></span></button> <button type="button" aria-label="Python" class="mobile-dropdown-title"><span class="title">Python</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/python/tools/" class="nav-link">
  Tools
</a></li><li class="dropdown-item"><!----> <a href="/python/packages/" class="nav-link">
  Packages
</a></li><li class="dropdown-item"><!----> <a href="/python/django/" class="nav-link">
  Django
</a></li><li class="dropdown-item"><!----> <a href="/python/数据挖掘/" class="nav-link">
  数据挖掘
</a></li><li class="dropdown-item"><!----> <a href="/python/机器学习/" class="nav-link">
  机器学习
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="AI" class="dropdown-title"><span class="title">AI</span> <span class="arrow down"></span></button> <button type="button" aria-label="AI" class="mobile-dropdown-title"><span class="title">AI</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ai/ollama.html" class="nav-link">
  ollama
</a></li><li class="dropdown-item"><!----> <a href="https://chat.hwl.cool/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  NextChat
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Tools" class="dropdown-title"><span class="title">Tools</span> <span class="arrow down"></span></button> <button type="button" aria-label="Tools" class="mobile-dropdown-title"><span class="title">Tools</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tools/docker/" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/tools/git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/tools/wsl/" class="nav-link">
  WSL
</a></li><li class="dropdown-item"><!----> <a href="/tools/vim/" class="nav-link">
  Vim
</a></li><li class="dropdown-item"><!----> <a href="/tools/VSCode/" class="nav-link">
  VS Code
</a></li><li class="dropdown-item"><!----> <a href="/tools/ubuntu/" class="nav-link">
  Ubuntu
</a></li><li class="dropdown-item"><!----> <a href="/tools/centos/" class="nav-link">
  Centos
</a></li><li class="dropdown-item"><!----> <a href="/tools/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/tools/mac/" class="nav-link">
  Mac
</a></li></ul></div></div><div class="nav-item"><a href="/bookmarks/" class="nav-link">
  Bookmarks
</a></div> <a href="https://github.com/huwanlong/docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Web" class="dropdown-title"><span class="title">Web</span> <span class="arrow down"></span></button> <button type="button" aria-label="Web" class="mobile-dropdown-title"><span class="title">Web</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/tools/" class="nav-link">
  Tools
</a></li><li class="dropdown-item"><!----> <a href="/frontend/React/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/frontend/electron/" class="nav-link">
  Electron
</a></li><li class="dropdown-item"><!----> <a href="/frontend/webpack4/" class="nav-link">
  Webpack4
</a></li><li class="dropdown-item"><!----> <a href="/frontend/SSR/" class="nav-link">
  Vue SSR
</a></li><li class="dropdown-item"><!----> <a href="/frontend/MicroApp/" class="nav-link">
  MicroApp
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Python" class="dropdown-title"><span class="title">Python</span> <span class="arrow down"></span></button> <button type="button" aria-label="Python" class="mobile-dropdown-title"><span class="title">Python</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/python/tools/" class="nav-link">
  Tools
</a></li><li class="dropdown-item"><!----> <a href="/python/packages/" class="nav-link">
  Packages
</a></li><li class="dropdown-item"><!----> <a href="/python/django/" class="nav-link">
  Django
</a></li><li class="dropdown-item"><!----> <a href="/python/数据挖掘/" class="nav-link">
  数据挖掘
</a></li><li class="dropdown-item"><!----> <a href="/python/机器学习/" class="nav-link">
  机器学习
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="AI" class="dropdown-title"><span class="title">AI</span> <span class="arrow down"></span></button> <button type="button" aria-label="AI" class="mobile-dropdown-title"><span class="title">AI</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ai/ollama.html" class="nav-link">
  ollama
</a></li><li class="dropdown-item"><!----> <a href="https://chat.hwl.cool/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  NextChat
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Tools" class="dropdown-title"><span class="title">Tools</span> <span class="arrow down"></span></button> <button type="button" aria-label="Tools" class="mobile-dropdown-title"><span class="title">Tools</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tools/docker/" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/tools/git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/tools/wsl/" class="nav-link">
  WSL
</a></li><li class="dropdown-item"><!----> <a href="/tools/vim/" class="nav-link">
  Vim
</a></li><li class="dropdown-item"><!----> <a href="/tools/VSCode/" class="nav-link">
  VS Code
</a></li><li class="dropdown-item"><!----> <a href="/tools/ubuntu/" class="nav-link">
  Ubuntu
</a></li><li class="dropdown-item"><!----> <a href="/tools/centos/" class="nav-link">
  Centos
</a></li><li class="dropdown-item"><!----> <a href="/tools/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/tools/mac/" class="nav-link">
  Mac
</a></li></ul></div></div><div class="nav-item"><a href="/bookmarks/" class="nav-link">
  Bookmarks
</a></div> <a href="https://github.com/huwanlong/docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/python/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" aria-current="page" class="sidebar-link">概述</a></li><li><a href="/python/机器学习/特征工程.html" class="active sidebar-link">特征工程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#数据集" class="sidebar-link">数据集</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#学习时可用数据集" class="sidebar-link">学习时可用数据集</a></li><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#kaggle" class="sidebar-link" style="padding-left:3rem;">Kaggle</a></li><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#uci" class="sidebar-link" style="padding-left:3rem;">UCI</a></li><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#scikit-learn" class="sidebar-link" style="padding-left:3rem;">scikit-learn</a></li><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#sklearn" class="sidebar-link">sklearn</a></li><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#安装" class="sidebar-link" style="padding-left:3rem;">安装</a></li><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#内容" class="sidebar-link" style="padding-left:3rem;">内容</a></li><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#介绍" class="sidebar-link" style="padding-left:3rem;">介绍</a></li><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#小数据集" class="sidebar-link" style="padding-left:3rem;">小数据集</a></li><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#大数据集" class="sidebar-link" style="padding-left:3rem;">大数据集</a></li><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#使用" class="sidebar-link" style="padding-left:3rem;">使用</a></li><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#划分" class="sidebar-link" style="padding-left:3rem;">划分</a></li></ul></li><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#特征工程" class="sidebar-link">特征工程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#特征抽取-特征提取" class="sidebar-link">特征抽取/特征提取</a></li><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#字典特征提取" class="sidebar-link" style="padding-left:3rem;">字典特征提取</a></li><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#文本特征提取" class="sidebar-link" style="padding-left:3rem;">文本特征提取</a></li><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#countvectorizer" class="sidebar-link" style="padding-left:4rem;">CountVectorizer</a></li><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#tfidfvectorizer" class="sidebar-link" style="padding-left:4rem;">TfidfVectorizer</a></li><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#公式" class="sidebar-link" style="padding-left:5rem;">公式</a></li><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#例子" class="sidebar-link" style="padding-left:5rem;">例子</a></li><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#对数" class="sidebar-link" style="padding-left:5rem;">对数</a></li><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#api" class="sidebar-link" style="padding-left:5rem;">API</a></li><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#特征预处理" class="sidebar-link">特征预处理</a></li><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#归一化" class="sidebar-link" style="padding-left:3rem;">归一化</a></li><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#标准化" class="sidebar-link" style="padding-left:3rem;">标准化</a></li><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#特征降维" class="sidebar-link">特征降维</a></li><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#特征选择" class="sidebar-link" style="padding-left:3rem;">特征选择</a></li><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#方法" class="sidebar-link" style="padding-left:4rem;">方法</a></li><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#模块" class="sidebar-link" style="padding-left:4rem;">模块</a></li><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#过滤式" class="sidebar-link" style="padding-left:4rem;">过滤式</a></li><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#低方差特征过滤" class="sidebar-link" style="padding-left:5rem;">低方差特征过滤</a></li><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#相关系数" class="sidebar-link" style="padding-left:5rem;">相关系数</a></li><li class="sidebar-sub-header"><a href="/python/机器学习/特征工程.html#主成分分析-pca" class="sidebar-link" style="padding-left:3rem;">主成分分析(PCA)</a></li></ul></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="数据集"><a href="#数据集" class="header-anchor">#</a> 数据集</h2> <h3 id="学习时可用数据集"><a href="#学习时可用数据集" class="header-anchor">#</a> 学习时可用数据集</h3> <p>分为训练集和测试集</p> <h4 id="kaggle"><a href="#kaggle" class="header-anchor">#</a> Kaggle</h4> <p><a href="https://www.kaggle.com/datasets" target="_blank" rel="noopener noreferrer">https://www.kaggle.com/datasets<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ol><li>大数据竞赛平台</li> <li>80 万科学家</li> <li>真实数据</li> <li>数据量巨大</li></ol> <h4 id="uci"><a href="#uci" class="header-anchor">#</a> UCI</h4> <p><a href="http://archive.ics.uci.edu/ml/" target="_blank" rel="noopener noreferrer">http://archive.ics.uci.edu/ml/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ol><li>收录了 559 个数据集</li> <li>覆盖科学、生活、经济等领域</li> <li>数据量几十万</li></ol> <h4 id="scikit-learn"><a href="#scikit-learn" class="header-anchor">#</a> scikit-learn</h4> <p><a href="http://scikit-learn.org/stable/datasets/index.html#datasets" target="_blank" rel="noopener noreferrer">http://scikit-learn.org/stable/datasets/index.html#datasets<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ol><li>数据量较小</li> <li>方便学习</li></ol> <h3 id="sklearn"><a href="#sklearn" class="header-anchor">#</a> sklearn</h3> <h4 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 创建一个包含sklearn的环境</span>
conda create <span class="token parameter variable">-n</span> machine python Scikit-learn ipython jieba pandas
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="内容"><a href="#内容" class="header-anchor">#</a> 内容</h4> <ol><li>Classification 分类</li> <li>Regresslon 回归</li> <li>Clustering 聚类</li> <li>Dimenslonality reduction 降维</li> <li>Model Selection 模型选择</li> <li>Preprocessing 特征工程</li></ol> <h4 id="介绍"><a href="#介绍" class="header-anchor">#</a> 介绍</h4> <p>sklearn.datasets</p> <p>加载获取流行数据集</p> <ol><li><p>datasets.load_*()</p> <p>获取小规模数据集，数据包含在 datasets 里</p></li> <li><p>datasets.fetch_*(data_home=None)</p> <p>获取大规模数据集，需要从网络上下载，函数的第一个参数是 data_home，表示数据下载的目录，默认是~/scikit_learn_data/</p></li></ol> <h4 id="小数据集"><a href="#小数据集" class="header-anchor">#</a> 小数据集</h4> <ol><li><p>sklearn.datasets.load_iris()</p> <p>加载并返回鸢尾花数据集</p></li> <li><p>sklearn.datasets.load_boston()</p> <p>加载并返回波士顿房价数据集</p></li></ol> <h4 id="大数据集"><a href="#大数据集" class="header-anchor">#</a> 大数据集</h4> <p>sklearn.datasets.fetch_20newsgroups(data_home=None, subset='train')</p> <ol><li>subset: 'train' 或者 'test'， 'all' ，可选，选择要加载的数据集</li> <li>训练集的“训练”，测试集的“测试，两都的”全部“</li></ol> <h4 id="使用"><a href="#使用" class="header-anchor">#</a> 使用</h4> <p>sklearn 数据集返回值介绍，load 和 fetch 返回的数据类型 datasets.base.Bunch(字典格式)</p> <ol><li>data: 特征数据数组，是 [n_samples * n_features] 的二维 numpy.ndarray 数组</li> <li>target: 标签数组，是 n_samples 的一维 numpy.ndarray 数组</li> <li>DESCR: 数据描述</li> <li>feature_names: 特征名，新闻数据，手写数字，回归数据集没有</li> <li>target_names: 标签名</li></ol> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token triple-quoted-string string">&quot;&quot;&quot;
@author: hwl
@time: 2020-11-01 13:32:31
@description:
&quot;&quot;&quot;</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_iris

<span class="token keyword">def</span> <span class="token function">datasets_demo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    sklearn数据集使用
    :return:
    &quot;&quot;&quot;</span>
    iris <span class="token operator">=</span> load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;数据集: \n&quot;</span><span class="token punctuation">,</span> iris<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;特征值：\n&quot;</span><span class="token punctuation">,</span> iris<span class="token punctuation">.</span>data<span class="token punctuation">,</span> iris<span class="token punctuation">.</span>data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;目标值：\n&quot;</span><span class="token punctuation">,</span> iris<span class="token punctuation">.</span>target<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;特征的名字：\n&quot;</span><span class="token punctuation">,</span> iris<span class="token punctuation">.</span>feature_names<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;目标值的名字：\n&quot;</span><span class="token punctuation">,</span> iris<span class="token punctuation">.</span>target_names<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;描述：\n&quot;</span><span class="token punctuation">,</span> iris<span class="token punctuation">.</span>DESCR<span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token boolean">None</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    <span class="token comment"># 代码1：sklearn数据集使用</span>
    datasets_demo<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h4 id="划分"><a href="#划分" class="header-anchor">#</a> 划分</h4> <p>训练数据：用于训练，构建模型</p> <p>测试数据：在模型检验时使用，用于评估模型是否有效</p> <p>测试集 20%~30%</p> <p>sklearn.model_selection.train_test_split(arrays, *options)</p> <ol><li>x 数据集的特征值</li> <li>y 数据集的标签值</li> <li>test_size 测试集的大小，一般为 float</li> <li>random_state 随机数种子，不同的种子会造成不同的随机采样结果。相同的种子采样结果相同</li> <li>return 训练集特征值，测试集特征值，训练集目标集，测试集目标集</li></ol> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token triple-quoted-string string">&quot;&quot;&quot;
@author: hwl
@time: 2020-11-01 14:22:20
@description:
&quot;&quot;&quot;</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_iris
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split

<span class="token keyword">def</span> <span class="token function">datasets_demo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    sklearn数据集使用
    :return:
    &quot;&quot;&quot;</span>
    iris <span class="token operator">=</span> load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;数据集: \n&quot;</span><span class="token punctuation">,</span> iris<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;特征值：\n&quot;</span><span class="token punctuation">,</span> iris<span class="token punctuation">.</span>data<span class="token punctuation">,</span> iris<span class="token punctuation">.</span>data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;目标值：\n&quot;</span><span class="token punctuation">,</span> iris<span class="token punctuation">.</span>target<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;特征的名字：\n&quot;</span><span class="token punctuation">,</span> iris<span class="token punctuation">.</span>feature_names<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;目标值的名字：\n&quot;</span><span class="token punctuation">,</span> iris<span class="token punctuation">.</span>target_names<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;描述：\n&quot;</span><span class="token punctuation">,</span> iris<span class="token punctuation">.</span>DESCR<span class="token punctuation">)</span>

    <span class="token comment"># 数据集划分</span>
    x_train<span class="token punctuation">,</span> x_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>iris<span class="token punctuation">.</span>data<span class="token punctuation">,</span> iris<span class="token punctuation">.</span>target<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">22</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;训练集特征值：\n&quot;</span><span class="token punctuation">,</span> x_train<span class="token punctuation">,</span> x_train<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token boolean">None</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    <span class="token comment"># 代码1：sklearn数据集使用</span>
    datasets_demo<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h2 id="特征工程"><a href="#特征工程" class="header-anchor">#</a> 特征工程</h2> <p>吴恩达：“数据和特征决定了机器学习的上限，而模型和算法只是逼近这个上限而已”</p> <p>特征工程是使用专业背景知识和技巧处理数据，使得特征能在机器学习算法上发挥更好的作用的过程。</p> <p>意义：会直接影响机器学习的效果</p> <p>pandas：一个数据读取非常方便以及基本的处理格式的工具，用于数据清洗、数据处理</p> <p>sklearn：对于特征的处理提供了强大的接口</p> <h3 id="特征抽取-特征提取"><a href="#特征抽取-特征提取" class="header-anchor">#</a> 特征抽取/特征提取</h3> <p>将任意数据（如文本或图像）转换为可用于机器学习的数字特征</p> <p>注：特征值化是为了计算机更好的去理解数据</p> <ul><li>字典特征提取（特征离散化）</li> <li>文本特征提取</li> <li>图像特征提取（深度学习将介绍）</li></ul> <p>API：sklearn.feature_extraction</p> <ol><li>应用 DictVectorizer 实现对类别特征进行数值化、离散化</li> <li>应用 CountVectorizer 实现对文本特征进行数值化</li> <li>应用 TfidfVectorizer 实现对文本特征进行数值化</li></ol> <h4 id="字典特征提取"><a href="#字典特征提取" class="header-anchor">#</a> 字典特征提取</h4> <p>作用：对字典数据进行特征值化</p> <p>类别 -&gt; one-hot 编码（独热编码）</p> <p>sklearn.feature_extraction.DictVectorizer(sparse=True,...)</p> <ul><li>DictVectorizer.fit_transform(X) X:字典或者包含字典的迭代器返回 sparse 矩阵（稀疏矩阵 - 将非零值按位置表示出来，可以节省内存，提高加载效率）</li> <li>DictVectorizer.inverse_transform(X) X:array 数组或者 sparse 矩阵 返回值：转换之前数据格式</li> <li>DictVectorizer.get_feature_names() 返回类别名称</li></ul> <p>总结：对于特征当中存在类别信息的我们都会做 one-hot 编码处理</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token triple-quoted-string string">&quot;&quot;&quot;
@author: hwl
@time: 2020-11-01 17:18:23
@description:
&quot;&quot;&quot;</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_extraction <span class="token keyword">import</span> DictVectorizer

<span class="token keyword">def</span> <span class="token function">dict_demo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    字典特征抽取
    :return:
    &quot;&quot;&quot;</span>
    data <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span><span class="token string">'city'</span><span class="token punctuation">:</span> <span class="token string">'北京'</span><span class="token punctuation">,</span> <span class="token string">'temperature'</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span><span class="token string">'city'</span><span class="token punctuation">:</span> <span class="token string">'上海'</span><span class="token punctuation">,</span> <span class="token string">'temperature'</span><span class="token punctuation">:</span> <span class="token number">60</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span><span class="token string">'city'</span><span class="token punctuation">:</span> <span class="token string">'深圳'</span><span class="token punctuation">,</span> <span class="token string">'temperature'</span><span class="token punctuation">:</span> <span class="token number">30</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
    <span class="token comment"># 1、实例化一个转换器类</span>
    transfer <span class="token operator">=</span> DictVectorizer<span class="token punctuation">(</span>sparse<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    <span class="token comment"># 2、调用fit_transform</span>
    data_new <span class="token operator">=</span> transfer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;data_new:\n&quot;</span><span class="token punctuation">,</span> data_new<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;特征名字:\n&quot;</span><span class="token punctuation">,</span> transfer<span class="token punctuation">.</span>get_feature_names<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token boolean">None</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    <span class="token comment"># 代码2：字典特征抽取</span>
    dict_demo<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p>应用场景：</p> <ol><li>数据集当中类别特征比较多</li> <li>本身拿到的数据就是字典类型</li></ol> <h4 id="文本特征提取"><a href="#文本特征提取" class="header-anchor">#</a> 文本特征提取</h4> <p>特征：单词（这里也叫特征词），如果是对中文做文本特征提取，需要把词用空格格开</p> <p>作用：对文本数据进行特征值化</p> <h5 id="countvectorizer"><a href="#countvectorizer" class="header-anchor">#</a> CountVectorizer</h5> <p><strong>sklearn.feature_extraction.text.CountVectorizer(stop_words=[]) 返回词频矩阵</strong>，stop_words 停用词列表，表示没什么用，就不做特征词了，可以到网上找停用词表</p> <p>CountVectorizer.fit_transform(X) X: 文本或者包含文本字符串的可迭代对象 返回值：返回 sparse 矩阵</p> <p>CountVectorizer.inverse_transform(X) X: array 数组或者 sparse 矩阵 返回值：转换之前数据格</p> <p>CountVectorizer.get_feature_names() 返回值：单词列表</p> <p><strong>sklearn.feature_extraction.text.TfidfVectorizer</strong></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>conda <span class="token function">install</span> jieba
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token triple-quoted-string string">&quot;&quot;&quot;
@author: hwl
@time: 2020-11-02 21:27:59
@description:
&quot;&quot;&quot;</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_extraction<span class="token punctuation">.</span>text <span class="token keyword">import</span> CountVectorizer
<span class="token keyword">import</span> jieba

<span class="token keyword">def</span> <span class="token function">count_demo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    文本特征提取：CountVecotrizer
    :return:
    &quot;&quot;&quot;</span>
    data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;life is short, i like like python&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;life is too long, i dislike python&quot;</span><span class="token punctuation">]</span>
    <span class="token comment"># 1、实例化一个转换器类</span>
    transfer <span class="token operator">=</span> CountVectorizer<span class="token punctuation">(</span>stop_words<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;is&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;too&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment"># 2、调用fit_transform</span>
    data_new <span class="token operator">=</span> transfer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;data_new:\n&quot;</span><span class="token punctuation">,</span> data_new<span class="token punctuation">.</span>toarray<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;特征名字:\n&quot;</span><span class="token punctuation">,</span> transfer<span class="token punctuation">.</span>get_feature_names<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token boolean">None</span>

<span class="token keyword">def</span> <span class="token function">count_chinese_demo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    中文文本特征提取：CountVecotrizer
    :return:
    &quot;&quot;&quot;</span>
    data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;我 爱 北京 天安门&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;天安门 上 太阳 升&quot;</span><span class="token punctuation">]</span>
    <span class="token comment"># 1、实例化一个转换器类</span>
    transfer <span class="token operator">=</span> CountVectorizer<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 2、调用fit_transform</span>
    data_new <span class="token operator">=</span> transfer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;data_new:\n&quot;</span><span class="token punctuation">,</span> data_new<span class="token punctuation">.</span>toarray<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;特征名字:\n&quot;</span><span class="token punctuation">,</span> transfer<span class="token punctuation">.</span>get_feature_names<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token boolean">None</span>

<span class="token keyword">def</span> <span class="token function">cut_word</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    进行中文分词
    :param text:
    :return:
    &quot;&quot;&quot;</span>
    <span class="token keyword">return</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>jieba<span class="token punctuation">.</span>cut<span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">count_chinese_demo2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    中文文本特征抽取，自动分词
    :return:
    &quot;&quot;&quot;</span>
    <span class="token comment"># 将中文文本进行分词</span>
    data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;一种还是一种今天很残酷，后天很美好，但绝对大部分是死在明天晚上，所以每个人不要放弃今天。&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;我们看到的从很远星系来的光是在几百万年之前发出的，这样当我们看到宇宙时，我们是在看它的过去。&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;如果只用一种方式了解某样事物，你就不会真正了解它。了解事物真正含义的秘密取决于如何装其与我们所了解的事物相联系。&quot;</span><span class="token punctuation">]</span>
    data_new <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> sent <span class="token keyword">in</span> data<span class="token punctuation">:</span>
        data_new<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cut_word<span class="token punctuation">(</span>sent<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># 1、实例化一个转换器类</span>
    transfer <span class="token operator">=</span> CountVectorizer<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 2、调用fit_transform</span>
    data_final <span class="token operator">=</span> transfer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>data_new<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;data_new:\n&quot;</span><span class="token punctuation">,</span> data_final<span class="token punctuation">.</span>toarray<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;特征名字:\n&quot;</span><span class="token punctuation">,</span> transfer<span class="token punctuation">.</span>get_feature_names<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token boolean">None</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    <span class="token comment"># 代码3：文本特征提取</span>
    <span class="token comment"># count_demo()</span>
    <span class="token comment"># 代码4：中文文本特征提取</span>
    <span class="token comment"># count_chinese_demo()</span>
    <span class="token comment"># 代码5：中文分词</span>
    <span class="token comment"># print(cut_word(&quot;我爱北京天安门&quot;))</span>
    <span class="token comment"># 代码6：中文文本特征提取，自动分词</span>
    count_chinese_demo2<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br></div></div><p>关键词：在某一个类别的文章中，出现的次数很多，但是在其他类别的文章当中出现很少</p> <h5 id="tfidfvectorizer"><a href="#tfidfvectorizer" class="header-anchor">#</a> TfidfVectorizer</h5> <p>TF-IDF 的主要思想是：如果某个词或短语在一篇文章中出现的概率高，并且在其他文章中很少出现，则认为此词或短语具有很好的类别区分能力，适合用来分类</p> <p>TF-IDF 作用：用以评估一字词对于一个文件集或一个语料库中的其中一份文件的重要程度</p> <h6 id="公式"><a href="#公式" class="header-anchor">#</a> 公式</h6> <p>词频（term frequency, tf）指的是某一个给定的词语在该文件中出现的频率</p> <p>逆向文档频率（inverse document frequency, idf）是一个词语普通重要性的度量。某一特定词语的 idf, 可以由总文件数目除以包含词语之文件的数目，再将得到的商取以 10 为底的对数得到</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mi>f</mi><mi>i</mi><mi>d</mi><msub><mi>f</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo>=</mo><mi>t</mi><msub><mi>f</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo>×</mo><mi>i</mi><mi>d</mi><msub><mi>f</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">tfidf_{i,j} = tf_{i,j} \times idf_i
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">t</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">i</span><span class="mord mathit">d</span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathit">t</span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">×</span><span class="mord mathit">i</span><span class="mord mathit">d</span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></p> <p>TF_IDF 表示重要程度</p> <h6 id="例子"><a href="#例子" class="header-anchor">#</a> 例子</h6> <ul><li><p>有两个词“经济”，“非常” ，有 1000 篇文章的 语料库，其中 100 篇文章有“非常”，10 篇文章有“经济”</p></li> <li><p>有两篇文章，文章 A（100 词）：10 次“经济”</p> <p>tf: 10 / 100 = 0.1</p> <p>idf: lg 1000/10 = 2</p> <p>TF-IDF: 0.1 * 2 = 0.2</p></li> <li><p>文章 B（100 词）：10 次“非常”</p> <p>tf: 10 / 100 = 0.1</p> <p>idf: log 10 1000/100 = 1</p> <p>TF-IDF: 0.1 * 1 = 0.1</p></li></ul> <h6 id="对数"><a href="#对数" class="header-anchor">#</a> 对数</h6> <p>指数：2^3 = 8</p> <p>对数：</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mn>8</mn><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">log_2 8 = 3
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathrm">8</span><span class="mrel">=</span><span class="mord mathrm">3</span></span></span></span></span></p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mi>o</mi><msub><mi>g</mi><mrow><mn>1</mn><mn>0</mn></mrow></msub><mn>1</mn><mn>0</mn><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">log_{10} 10 = 1
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span><span class="mord mathrm">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathrm">1</span><span class="mord mathrm">0</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span></span></p> <p>log 10 可以简写成 lg</p> <h6 id="api"><a href="#api" class="header-anchor">#</a> API</h6> <p>sklearn.feature_extraction.text.TfidfVectorizer(stop_words=None,...)</p> <p>返回词的权重矩阵</p> <p>TfidfVectorizer.fit_transform(x) X:文本或者包含文本字符串的可迭代对象 返回值：返回 sparse 矩阵</p> <p>TfidfVectorizer.inverse_transform(x) X:array 数组或者 sparse 矩阵 返回值：转换之前数据格式</p> <p>TfidfVectorizer.get_feature_names() 返回值：单词列表</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_extraction<span class="token punctuation">.</span>text <span class="token keyword">import</span> TfidfVectorizer
<span class="token keyword">def</span> <span class="token function">tfidf_demo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    用TF—IDF的方法进行文本特征提取
    :return:
    &quot;&quot;&quot;</span>
    <span class="token comment"># 将中文文本进行分词</span>
    data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;一种还是一种今天很残酷，后天很美好，但绝对大部分是死在明天晚上，所以每个人不要放弃今天。&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;我们看到的从很远星系来的光是在几百万年之前发出的，这样当我们看到宇宙时，我们是在看它的过去。&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;如果只用一种方式了解某样事物，你就不会真正了解它。了解事物真正含义的秘密取决于如何装其与我们所了解的事物相联系。&quot;</span><span class="token punctuation">]</span>
    data_new <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> sent <span class="token keyword">in</span> data<span class="token punctuation">:</span>
        data_new<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cut_word<span class="token punctuation">(</span>sent<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># 1、实例化一个转换器类</span>
    transfer <span class="token operator">=</span> TfidfVectorizer<span class="token punctuation">(</span>stop_words<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;一种&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;所以&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment"># 2、调用fit_transform</span>
    data_final <span class="token operator">=</span> transfer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>data_new<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;data_new:\n&quot;</span><span class="token punctuation">,</span> data_final<span class="token punctuation">.</span>toarray<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;特征名字:\n&quot;</span><span class="token punctuation">,</span> transfer<span class="token punctuation">.</span>get_feature_names<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token boolean">None</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    <span class="token comment"># 代码7：tfidf</span>
    tfidf_demo<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h3 id="特征预处理"><a href="#特征预处理" class="header-anchor">#</a> 特征预处理</h3> <p>什么是特征预处理？</p> <p>通过一些转换函数奖特征数据转换成更加适合算法模型的特征数据过程</p> <p>为什么我们要进行归一化/标准化？</p> <p>特征的单位或者大小相差较大，或者某特征的方差相比其他的特征要大出几个数量级，容易影响(支配)目标结果，使得一些算法无法学习到其它的特征</p> <p>我们需要用到一些方法进行无量纲化，使不同规格的数据转换到同一规格</p> <h4 id="归一化"><a href="#归一化" class="header-anchor">#</a> 归一化</h4> <p>定义：通过对原始数据进行变换把数据映射到（默认为[0,1]）之间</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup><mo>=</mo><mfrac><mrow><mi>x</mi><mo>−</mo><mi>m</mi><mi>i</mi><mi>n</mi></mrow><mrow><mi>m</mi><mi>a</mi><mi>x</mi><mo>−</mo><mi>m</mi><mi>i</mi><mi>n</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">x' = \frac{x - min}{max - min}
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:1.3365200000000002em;"></span><span class="strut bottom" style="height:2.10585em;vertical-align:-0.7693300000000001em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord mathit">x</span><span class="mbin">−</span><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">n</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">x</span><span class="mbin">−</span><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mrow><mi mathvariant="normal">′</mi><mi mathvariant="normal">′</mi></mrow></msup><mo>=</mo><msup><mi>x</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup><mo>∗</mo><mo>(</mo><mi>m</mi><mi>x</mi><mo>−</mo><mi>m</mi><mi>i</mi><mo>)</mo><mo>+</mo><mi>m</mi><mi>i</mi></mrow><annotation encoding="application/x-tex">x'' = x' * (mx -mi) + mi
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.801892em;"></span><span class="strut bottom" style="height:1.051892em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">∗</span><span class="mopen">(</span><span class="mord mathit">m</span><span class="mord mathit">x</span><span class="mbin">−</span><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit">m</span><span class="mord mathit">i</span></span></span></span></span></p> <p>作用于每一列，max 为一列的最大值，min 为一列的最小值 ，x''为最终结果，mx, mi 分别为指定区间值默认 mx 为 1，mi 为 0</p> <p>方法：</p> <p>sklearn.preprocessing.MinMaxScaler(feature_range=(0,1)...)</p> <p>MinMaxScalar.fit_transform(X) X:numpy_array 格式的数据[n_samples,n_features]</p> <p>返回值：转换后的形状相同的 array</p> <p>注意最大值最小值是变化的，另外，最大值与最小值非常容易受异常点影响，所以这种方法鲁棒性较差，只适合传统精确小数据场景。</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> MinMaxScaler
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">def</span> <span class="token function">minmax_demo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    归一化
    :return:
    &quot;&quot;&quot;</span>
    <span class="token comment"># 1、获取数据</span>
    data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'dating.txt'</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;data:\n&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
    data <span class="token operator">=</span> data<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;data:\n&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>

    <span class="token comment"># 2、实例化一个转换器类</span>
    transfer <span class="token operator">=</span> MinMaxScaler<span class="token punctuation">(</span>feature_range<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment"># 3、调用fit_transform</span>
    data_new <span class="token operator">=</span> transfer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;data_new:\n&quot;</span><span class="token punctuation">,</span> data_new<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token boolean">None</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    <span class="token comment"># 代码8：归一化</span>
    minmax_demo<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h4 id="标准化"><a href="#标准化" class="header-anchor">#</a> 标准化</h4> <p>定义：通过对原始数据进行变换把数据变换到均值为 0，标准差为 1 范围内</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup><mo>=</mo><mfrac><mrow><mi>x</mi><mo>−</mo><mi>m</mi><mi>e</mi><mi>a</mi><mi>n</mi></mrow><mrow><mi>σ</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">x' = \frac{x - mean}{\sigma}
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:1.2603300000000002em;"></span><span class="strut bottom" style="height:1.9463300000000001em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">σ</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">x</span><span class="mbin">−</span><span class="mord mathit">m</span><span class="mord mathit">e</span><span class="mord mathit">a</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></p> <p>作用于每一列，mean 为平均值，σ 为标准差</p> <p>方法：</p> <p>sklearn.preprocessing.StandardScaler()</p> <p>处理之后，对每列来说，所有数据都聚集在均值为 0 附近，标准差为 1</p> <p>StandardScaler.fit_transform(X) X:numpy array 格式的数据[n_samples,n_features]</p> <p>返回值：转换后的形状相同的 array</p> <p>在已有样本足够多的情况下比较稳定，适合现代嘈杂大数据场景</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScaler
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">def</span> <span class="token function">stand_demo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    标准化
    :return:
    &quot;&quot;&quot;</span>
    <span class="token comment"># 1、获取数据</span>
    data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'dating.txt'</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;data:\n&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
    data <span class="token operator">=</span> data<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;data:\n&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>

    <span class="token comment"># 2、实例化一个转换器类</span>
    transfer <span class="token operator">=</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 3、调用fit_transform</span>
    data_new <span class="token operator">=</span> transfer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;data_new:\n&quot;</span><span class="token punctuation">,</span> data_new<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token boolean">None</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    <span class="token comment"># 代码9：标准化</span>
    stand_demo<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="特征降维"><a href="#特征降维" class="header-anchor">#</a> 特征降维</h3> <p>降维是指在某些限定条件下，降低随机变量（特征）个数，得到一组“不相关”主变量的过程</p> <p>降维的两种方法</p> <ul><li>特征选择</li> <li>主成分分析（可以理解一种特征提取的方式）</li></ul> <h4 id="特征选择"><a href="#特征选择" class="header-anchor">#</a> 特征选择</h4> <p>数据中包含冗余或相关变量（或称特征、属性、指标等），旨在从原有特征中找出主要特征</p> <h5 id="方法"><a href="#方法" class="header-anchor">#</a> 方法</h5> <ul><li><p>Filter(过滤式)：主要探究特征本身特点、特征与特征和目标值之间关联</p> <p>方差选择法：低方差特征过滤</p> <p>相关系数：特征与特征之间的相关程度</p></li> <li><p>Embedded(嵌入式)：算法自动选择特征（特征与目标值之间的关联）</p> <p>决策树：信息熵、信息增益</p> <p>正则化：L1、L2</p> <p>深度学习：卷积等</p></li></ul> <h5 id="模块"><a href="#模块" class="header-anchor">#</a> 模块</h5> <p>sklearn.feature_selection</p> <h5 id="过滤式"><a href="#过滤式" class="header-anchor">#</a> 过滤式</h5> <h6 id="低方差特征过滤"><a href="#低方差特征过滤" class="header-anchor">#</a> 低方差特征过滤</h6> <p>删除低方差的一些特征。再结合方差的大小来考虑这个方式的角度</p> <ul><li>特征方差小：某个特征大多样本的值比较相近</li> <li>特征方差大：某个特征很多样本的值都有差别</li></ul> <p>API</p> <p>sklearn.feature_selection.VarianceThreshold(threshold = 0.0)</p> <p>删除所有低方差特征</p> <p>Variance.fit_transform(X)</p> <p>X:numpy array 格式的数据[n_samples,n_features]</p> <p>返回值：训练集差异低于 threshold 的特征将被删除。默认值是保留所有非零方差特征，即删除所有样本中具有相同值的特征。</p> <h6 id="相关系数"><a href="#相关系数" class="header-anchor">#</a> 相关系数</h6> <p>皮尔逊相关系数(Pearson Correlation Coefficient) 反映变量之间相关关系密切程序的统计指标</p> <p>公式</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi><mo>=</mo><mfrac><mrow><mi>n</mi><mo>∑</mo><mrow><mi>x</mi><mi>y</mi></mrow><mo>−</mo><mo>∑</mo><mrow><mi>x</mi></mrow><mo>∑</mo><mrow><mi>y</mi></mrow></mrow><mrow><msqrt><mrow><mi>n</mi><mo>∑</mo><mrow><msup><mi>x</mi><mn>2</mn></msup></mrow><mo>−</mo><mo>(</mo><mo>∑</mo><mrow><mi>x</mi></mrow><msup><mo>)</mo><mn>2</mn></msup></mrow></msqrt><msqrt><mrow><mi>n</mi><mo>∑</mo><mrow><msup><mi>y</mi><mn>2</mn></msup></mrow><mo>−</mo><mo>(</mo><mo>∑</mo><mrow><mi>y</mi></mrow><msup><mo>)</mo><mn>2</mn></msup></mrow></msqrt></mrow></mfrac></mrow><annotation encoding="application/x-tex">r = \frac{n\sum{xy} - \sum{x}\sum{y}}{\sqrt{n\sum{x^2} - (\sum{x})^2}\sqrt{n\sum{y^2} - (\sum{y})^2}}
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:1.427em;"></span><span class="strut bottom" style="height:2.55701em;vertical-align:-1.13001em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.825em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="sqrt mord"><span class="sqrt-sign" style="top:-0.04500000000000004em;"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size1">√</span></span></span><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="mord textstyle cramped"><span class="mord mathit">n</span><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">∑</span><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mbin">−</span><span class="mopen">(</span><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">∑</span><span class="mord textstyle cramped"><span class="mord mathit">x</span></span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span style="top:-0.855em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle uncramped sqrt-line"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span>​</span></span></span><span class="sqrt mord"><span class="sqrt-sign" style="top:-0.04500000000000004em;"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size1">√</span></span></span><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="mord textstyle cramped"><span class="mord mathit">n</span><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">∑</span><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mbin">−</span><span class="mopen">(</span><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">∑</span><span class="mord textstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">y</span></span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span style="top:-0.855em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle uncramped sqrt-line"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span>​</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">n</span><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">∑</span><span class="mord textstyle uncramped"><span class="mord mathit">x</span><span class="mord mathit" style="margin-right:0.03588em;">y</span></span><span class="mbin">−</span><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">∑</span><span class="mord textstyle uncramped"><span class="mord mathit">x</span></span><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">∑</span><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></p> <p>特点</p> <p>相关系数的值介于-1 与+1 之间，即-1 &lt;= r &lt;= +1。其性质如下：</p> <ul><li>当 r&gt;0 时，表示两变量正相关，r&lt;0 时，两变量为负相关</li> <li>当|r|=1 时，表示两变量为完全相关，当 r=0 时，表示两变量间无相关关系</li> <li>当 0&lt;|r|&lt;1 时，表示两变量存在一定程序的相关。且|r|越接近 1，两变量间线性关系越密切；|r|越接近于 0，表示两变量的线性相关越弱</li> <li>一般可按三级划分：|r|&lt;0.4 为低度相关；0.4&lt;=r&lt;0.7 为显著性相关；0.7&lt;=|r|&lt;1 为高度线性相关</li></ul> <p>API</p> <p>from scipy.stats import pearsonr</p> <ul><li>x: (N,) array_like y: (N,) array_like</li> <li>Returns: (Pearson's correlation coefficient, p-value)</li></ul> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token triple-quoted-string string">&quot;&quot;&quot;
@author: hwl
@time: 2020-11-19 21:37:36
@description: 低方差特征过滤 相关系数
&quot;&quot;&quot;</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> scipy<span class="token punctuation">.</span>stats <span class="token keyword">import</span> pearsonr
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_selection <span class="token keyword">import</span> VarianceThreshold
<span class="token keyword">def</span> <span class="token function">variance_demo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    过滤低方差特征
    :return:
    &quot;&quot;&quot;</span>
    <span class="token comment"># 1、获取数据</span>
    data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;factor_returns.csv&quot;</span><span class="token punctuation">)</span>
    data <span class="token operator">=</span> data<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;data:\n&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
    <span class="token comment"># 2、实例化一个转换器类</span>
    transfer <span class="token operator">=</span> VarianceThreshold<span class="token punctuation">(</span>threshold<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
    <span class="token comment"># 3、调用fit_transform</span>
    data_new <span class="token operator">=</span> transfer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;data_new:\n&quot;</span><span class="token punctuation">,</span> data_new<span class="token punctuation">,</span> data_new<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>

    <span class="token comment"># 计算某两个变量之间的相关系数</span>
    r <span class="token operator">=</span> pearsonr<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">&quot;pe_ratio&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token string">&quot;pb_ratio&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;相关系数：\n&quot;</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token boolean">None</span>
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    <span class="token comment"># 代码10：低方差特征过滤</span>
    variance_demo<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p>当特征与特征之间相关性很高时：</p> <ul><li>选取其中一个</li> <li>加权求和</li> <li>主成分分析</li></ul> <h4 id="主成分分析-pca"><a href="#主成分分析-pca" class="header-anchor">#</a> 主成分分析(PCA)</h4> <p>定义：高维数据转化为低维数据的过程，在此过程中可能会舍弃原有数据、创造新的变量</p> <p>作用：是数据维数压缩，尽可能降低原数据的维数（复杂度），损失少量信息。</p> <p>应用：回归分析或者聚类分析</p> <p>sklearn.decomposition.PCA(n_components=None)</p> <ul><li>将数据分解为较低维数空间</li> <li>n_components:
<ul><li>小数：表示保留百分之多少的信息</li> <li>整数：减少到多少特征</li></ul></li> <li>PCA.fit_transform(X) X:numpy array 格式的数据[n_samples,n_features]</li> <li>返回值：转换后指定维度的 array</li></ul> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token triple-quoted-string string">&quot;&quot;&quot;
@author: hwl
@time: 2020-11-19 22:44:24
@description: PCA降维
&quot;&quot;&quot;</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>decomposition <span class="token keyword">import</span> PCA
<span class="token keyword">def</span> <span class="token function">pca_demo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    PCA降维
    :return:
    &quot;&quot;&quot;</span>
    data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

    <span class="token comment"># 1、实例化一个转换器类</span>
    <span class="token comment"># transfer = PCA(n_components=2)</span>
    transfer <span class="token operator">=</span> PCA<span class="token punctuation">(</span>n_components<span class="token operator">=</span><span class="token number">0.95</span><span class="token punctuation">)</span>

    <span class="token comment"># 2、调用fit_transform</span>
    data_new <span class="token operator">=</span> transfer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;data_new:\n&quot;</span><span class="token punctuation">,</span> data_new<span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token boolean">None</span>
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    <span class="token comment"># 代码11：PCA降维</span>
    pca_demo<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/huwanlong/docs/edit/main/docs/python/机器学习/特征工程.md" target="_blank" rel="noopener noreferrer">帮助我改善此页面！</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">2024-08-09 16:34:54</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/python/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" class="prev router-link-active">
        概述
      </a></span> <!----></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.dc113988.js" defer></script><script src="/assets/js/8.fcf2fa6b.js" defer></script><script src="/assets/js/1.884f0c81.js" defer></script><script src="/assets/js/71.58dad522.js" defer></script><script src="/assets/js/20.a18fb072.js" defer></script>
  </body>
</html>
